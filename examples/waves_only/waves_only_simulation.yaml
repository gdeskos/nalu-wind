Simulations:
- name: sim1
  time_integrator: ti_1
  optimizer: opt1

# Specify the linear system solvers.
linear_solvers:

  # solver for scalar equations
- name: solve_scalar
  type: tpetra
  method: gmres
  preconditioner: sgs
  tolerance: 1e-6
  max_iterations: 75
  kspace: 75
  output_level: 0

  # solver for the pressure Poisson equation
- name: solve_cont
  type: tpetra
  method: gmres
  preconditioner: muelu
  tolerance: 1e-6
  max_iterations: 75
  kspace: 75
  output_level: 0
  recompute_preconditioner: no
  muelu_xml_file_name: ./milestone.xml

realms:

- name: fluidRealm
  mesh: couette_waves_ic.exo
  use_edges: yes
  automatic_decomposition_type: rcb

  equation_systems:
    name: theEqSys
    max_iterations: 0

    solver_system_specification:
      velocity: solve_scalar
      pressure: solve_cont

    systems:

    - LowMachEOM:
        name: myLowMach
        max_iterations: 1
        convergence_tolerance: 1.0e-5

  material_properties:

    target_name: [fluid_part]
    specifications:

    - name: density
      type: constant
      value: 1.

    - name: viscosity
      type: constant
      value: 1.25e-04

  initial_conditions:
  - constant: ic_1
    target_name: [fluid_part]
    value:
      pressure: 0.0
      velocity: [1., 0.0, 0.0]

  boundary_conditions:

  - periodic_boundary_condition: bc_inlet_outlet
    target_name: [inlet, outlet]
    periodic_user_data:
      search_tolerance: 0.0001

  - periodic_boundary_condition: bc_front_back
    target_name: [front, back]
    periodic_user_data:
      search_tolerance: 0.0001

  - inflow_boundary_condition: bc_topwall
    target_name: topwall
    inflow_user_data:
      velocity: [1.,0,0]

  - wall_boundary_condition: bc_bottomwall
    target_name: bottomwall
    wall_user_data:
      velocity: [0, 0, 0]      
      use_wall_function: no 

  mesh_motion:
    - name: waterwaves 
      mesh_parts: [fluid_part]
      frame: non_inertial
      motion:
        - type: water_waves
          wave_motion_model: Linear_prescribed
          amplitude: 0.01591549 
          waveperiod: 1.42857143
          wavelength: 1.0

  solution_options:
    name: myOptions
    turbulence_model: laminar 

    options:       
        - hybrid_factor:
            velocity: 0.0
        - alpha:
            velocity: 0.0
        - limiter:
            pressure: no
            velocity: no
        - projected_nodal_gradient:
            velocity: element
            pressure: element 
        - input_variables_from_file:
            velocity: velocity
        - source_terms: 
            momentum: body_force
        - source_term_parameters:
            momentum: [0.0,0.0,0.0]
  output:
    output_data_base_name: output/couette_waves_c3.exo
    output_frequency: 5
    output_node_set: no
    output_variables:
    - velocity
    - pressure
    - velocity_ra_stats
    - reynolds_stress
    - mesh_displacement
    - mesh_velocity
  
  turbulence_averaging:
    forced_reset: no
    time_filter_interval: 200.1
    averaging_type: nalu_classic
    specifications:
      - name: stats 
        target_name: fluid_part
        reynolds_averaged_variables:
          - velocity
        compute_tke: yes
        compute_reynolds_stress: yes
 
  restart:
    restart_data_base_name: restart/couette_waves_c3.rst
    output_frequency: 10000 

 
Time_Integrators:
- StandardTimeIntegrator:
    name: ti_1
    start_time: 0.0
    termination_step_count: 100 
    time_step: 0.1
    time_stepping_type: fixed
    time_step_count: 0
    second_order_accuracy: yes

    realms:
    - fluidRealm
